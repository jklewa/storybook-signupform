(self.webpackChunkstorybook_signupform=self.webpackChunkstorybook_signupform||[]).push([[551],{"./src/SignUpForm.stories.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AllFieldsRequired:function(){return AllFieldsRequired},BlankForm:function(){return BlankForm},InvalidEmail:function(){return InvalidEmail},ValidExample:function(){return ValidExample},__namedExportsOrder:function(){return __namedExportsOrder},default:function(){return SignUpForm_stories}});var regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),_excluded=["value","name","options","onChange"],DropdownField=function DropdownField(_ref){var value=_ref.value,name=_ref.name,options=_ref.options,onChange=_ref.onChange,_useState=((0,objectWithoutProperties.Z)(_ref,_excluded),(0,react.useState)(value)),_useState2=(0,slicedToArray.Z)(_useState,2),selectedValue=_useState2[0],setSelectedValue=_useState2[1],selectedValueNotInOptions=(0,react.useMemo)((function(){return""!==selectedValue&&void 0===options.find((function(o){return o.value===selectedValue}))}),[selectedValue,options]);return(0,jsx_runtime.jsxs)("select",{value:selectedValue,onChange:function handleSelectChange(event){setSelectedValue(event.target.value),onChange(event)},name:name,children:[(0,jsx_runtime.jsx)("option",{value:"",children:"Select an option"}),selectedValueNotInOptions()?(0,jsx_runtime.jsx)("option",{children:selectedValue},selectedValue):"",options.map((function(option){return(0,jsx_runtime.jsx)("option",{value:option.value,children:option.label},option.value)}))]})};DropdownField.__docgenInfo={description:"Dropdown (select) input field with dynamic options",methods:[],displayName:"DropdownField",props:{value:{description:"",type:{name:"string"},required:!1},name:{description:"",type:{name:"string"},required:!1},options:{description:"",type:{name:"arrayOf",value:{name:"shape",value:{label:{name:"string",required:!1},value:{name:"string",required:!1}}}},required:!1},onChange:{description:"",type:{name:"func"},required:!1}}};var SignUpForm_excluded=["initialData","onSubmit"],SignUpForm=function SignUpForm(_ref){var initialData=_ref.initialData,onSubmit=_ref.onSubmit,defaults=((0,objectWithoutProperties.Z)(_ref,SignUpForm_excluded),(0,objectSpread2.Z)({firstName:"",lastName:"",state:"",city:"",email:"",password:""},initialData)),_useState=(0,react.useState)(defaults),_useState2=(0,slicedToArray.Z)(_useState,2),formValues=_useState2[0],setFormValues=_useState2[1],handleInputChange=function handleInputChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setFormValues((function(prevState){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},prevState),{},(0,defineProperty.Z)({},name,value))}))},_useState3=(0,react.useState)(""),_useState4=(0,slicedToArray.Z)(_useState3,2),accessToken=_useState4[0],setAccessToken=_useState4[1];(0,react.useEffect)((function(){var fetchAccessToken=function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(){var response,data;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!accessToken){_context.next=2;break}return _context.abrupt("return");case 2:return _context.prev=2,_context.next=5,fetch("https://www.universal-tutorial.com/api/getaccesstoken",{headers:{Accept:"application/json","api-token":"-NSPhPlg3ke3T1yqQKs9CpMGzZbZppEMTgn-WJVWedzOwv1zhz_YNOJBT2d18hJYqt8","user-email":"jklewa@gmail.com"}});case 5:return response=_context.sent,_context.next=8,response.json();case 8:data=_context.sent,setAccessToken(data.auth_token),_context.next=15;break;case 12:_context.prev=12,_context.t0=_context.catch(2),console.error(_context.t0);case 15:case"end":return _context.stop()}}),_callee,null,[[2,12]])})));return function fetchAccessToken(){return _ref2.apply(this,arguments)}}();fetchAccessToken()}),[]);var _useState5=(0,react.useState)([]),_useState6=(0,slicedToArray.Z)(_useState5,2),stateOptions=_useState6[0],setStateOptions=_useState6[1],_useState7=(0,react.useState)({}),_useState8=(0,slicedToArray.Z)(_useState7,2),cityOptionsMap=_useState8[0],setCityOptionsMap=_useState8[1];(0,react.useEffect)((function(){var fetchStateOptions=function(){var _ref3=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(){var response,data,newVal;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_context2.prev=0,accessToken){_context2.next=3;break}return _context2.abrupt("return");case 3:return _context2.next=5,fetch("https://www.universal-tutorial.com/api/states/United States",{headers:{Accept:"application/json",Authorization:"Bearer ".concat(accessToken)}});case 5:return response=_context2.sent,_context2.next=8,response.json();case 8:data=_context2.sent,newVal=data.map((function(state){return{label:state.state_name,value:state.state_name}})),setStateOptions(newVal),_context2.next=16;break;case 13:_context2.prev=13,_context2.t0=_context2.catch(0),console.error(_context2.t0);case 16:case"end":return _context2.stop()}}),_callee2,null,[[0,13]])})));return function fetchStateOptions(){return _ref3.apply(this,arguments)}}();0===stateOptions.length&&fetchStateOptions()}),[accessToken]),(0,react.useEffect)((function(){var fetchCityOptionsForState=function(){var _ref4=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee3(state){var response,data,newVal;return(0,regeneratorRuntime.Z)().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(_context3.prev=0,accessToken){_context3.next=3;break}return _context3.abrupt("return");case 3:return _context3.next=5,fetch("https://www.universal-tutorial.com/api/cities/".concat(encodeURI(state)),{headers:{Accept:"application/json",Authorization:"Bearer ".concat(accessToken)}});case 5:return response=_context3.sent,_context3.next=8,response.json();case 8:data=_context3.sent,newVal=data.map((function(city){return{label:city.city_name,value:city.city_name}})),setCityOptionsMap((function(prevMap){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},prevMap),{},(0,defineProperty.Z)({},state,newVal))})),_context3.next=16;break;case 13:_context3.prev=13,_context3.t0=_context3.catch(0),console.error(_context3.t0);case 16:case"end":return _context3.stop()}}),_callee3,null,[[0,13]])})));return function fetchCityOptionsForState(_x){return _ref4.apply(this,arguments)}}();""===formValues.state||formValues.state in cityOptionsMap||fetchCityOptionsForState(formValues.state)}),[accessToken,formValues.state,cityOptionsMap]);var _useState9=(0,react.useState)([]),_useState10=(0,slicedToArray.Z)(_useState9,2),formErrors=_useState10[0],setFormErrors=_useState10[1];return(0,jsx_runtime.jsxs)("form",{children:[formErrors.length>0&&(0,jsx_runtime.jsxs)("div",{className:"errors",children:["The form has errors:",(0,jsx_runtime.jsx)("ul",{children:formErrors.map((function(error){return(0,jsx_runtime.jsx)("li",{children:error})}))})]}),(0,jsx_runtime.jsx)("label",{htmlFor:"firstName",children:"First Name "}),(0,jsx_runtime.jsx)("input",{type:"text",name:"firstName",value:formValues.firstName,onChange:handleInputChange}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("label",{htmlFor:"lastName",children:"Last Name "}),(0,jsx_runtime.jsx)("input",{type:"text",name:"lastName",value:formValues.lastName,onChange:handleInputChange}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("label",{htmlFor:"state",children:"State "}),(0,jsx_runtime.jsx)(DropdownField,{options:stateOptions,name:"state",value:formValues.state,onChange:handleInputChange}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("label",{htmlFor:"city",children:"City "}),(0,jsx_runtime.jsx)(DropdownField,{options:cityOptionsMap[formValues.state]||[],name:"city",value:formValues.city,onChange:handleInputChange}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("label",{htmlFor:"email",children:"Email "}),(0,jsx_runtime.jsx)("input",{type:"email",name:"email",value:formValues.email,onChange:handleInputChange}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("label",{htmlFor:"password",children:"Password "}),(0,jsx_runtime.jsx)("input",{type:"password",name:"password",value:formValues.password,onChange:handleInputChange}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsx)("button",{type:"button",onClick:function handleSubmit(event){event.preventDefault(),setFormErrors([]),function validateForm(){var errors=[];formValues.firstName||errors.push("First Name is required"),formValues.lastName||errors.push("Last Name is required"),formValues.state||errors.push("State is required"),formValues.city||errors.push("City is required"),formValues.password||errors.push("Password is required"),formValues.email?function isValidEmail(email){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)}(formValues.email)||errors.push("Please enter a valid Email"):errors.push("Email is required"),setFormErrors(errors),errors.length}(),onSubmit(formValues,formErrors)},children:"Submit"}),(0,jsx_runtime.jsxs)("pre",{children:["DEBUG Form Values: ",JSON.stringify(formValues,null,2)]}),(0,jsx_runtime.jsxs)("pre",{children:["DEBUG Form Errors: ",JSON.stringify(formErrors,null,2)]})]})};SignUpForm.__docgenInfo={description:"Basic signup form for a new user",methods:[],displayName:"SignUpForm",props:{initialData:{description:"",type:{name:"shape",value:{firstName:{name:"string",required:!1},lastName:{name:"string",required:!1},state:{name:"string",required:!1},city:{name:"string",required:!1},email:{name:"string",required:!1},password:{name:"string",required:!1}}},required:!0},onSubmit:{description:"",type:{name:"func"},required:!0}}};var esm=__webpack_require__("./node_modules/@storybook/testing-library/dist/esm/index.js"),react_esm=__webpack_require__("./node_modules/@testing-library/react/dist/@testing-library/react.esm.js"),SignUpForm_stories={title:"SignUpForm",component:SignUpForm},handleOnSubmit=function handleOnSubmit(data,errors){0!==errors.length?console.error(errors,data):console.log(data)},testSubmitEvent=function(){var _ref2=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(_ref){var canvasElement,canvas;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return canvasElement=_ref.canvasElement,canvas=(0,react_esm.uh)(canvasElement),_context.next=4,esm.mV.click(canvas.getByRole("button"));case 4:case"end":return _context.stop()}}),_callee)})));return function testSubmitEvent(_x){return _ref2.apply(this,arguments)}}(),BlankForm={args:{initialData:{},onSubmit:handleOnSubmit}},ValidExample={args:{initialData:{firstName:"Steve",lastName:"Jobs",state:"California",city:"Cupertino",email:"steve@apple.com",password:"iPhone4Life"},onSubmit:handleOnSubmit},play:testSubmitEvent},AllFieldsRequired={args:{initialData:{firstName:"",lastName:"",state:"",city:"",email:"",password:""},onSubmit:handleOnSubmit},play:testSubmitEvent},InvalidEmail={args:{initialData:{firstName:"Foo",lastName:"Bar",state:"California",city:"Cupertino",email:"not a valid email",password:"fooBar"},onSubmit:handleOnSubmit},play:testSubmitEvent},__namedExportsOrder=["BlankForm","ValidExample","AllFieldsRequired","InvalidEmail"];BlankForm.parameters={...BlankForm.parameters,docs:{...BlankForm.parameters?.docs,source:{originalSource:"{\n  args: {\n    initialData: {},\n    onSubmit: handleOnSubmit\n  }\n}",...BlankForm.parameters?.docs?.source}}},ValidExample.parameters={...ValidExample.parameters,docs:{...ValidExample.parameters?.docs,source:{originalSource:"{\n  args: {\n    initialData: {\n      firstName: 'Steve',\n      lastName: 'Jobs',\n      state: 'California',\n      city: 'Cupertino',\n      email: 'steve@apple.com',\n      password: 'iPhone4Life'\n    },\n    onSubmit: handleOnSubmit\n  },\n  play: testSubmitEvent\n}",...ValidExample.parameters?.docs?.source}}},AllFieldsRequired.parameters={...AllFieldsRequired.parameters,docs:{...AllFieldsRequired.parameters?.docs,source:{originalSource:"{\n  args: {\n    initialData: {\n      firstName: '',\n      lastName: '',\n      state: '',\n      city: '',\n      email: '',\n      password: ''\n    },\n    onSubmit: handleOnSubmit\n  },\n  play: testSubmitEvent\n}",...AllFieldsRequired.parameters?.docs?.source}}},InvalidEmail.parameters={...InvalidEmail.parameters,docs:{...InvalidEmail.parameters?.docs,source:{originalSource:"{\n  args: {\n    initialData: {\n      firstName: 'Foo',\n      lastName: 'Bar',\n      state: 'California',\n      city: 'Cupertino',\n      email: 'not a valid email',\n      password: 'fooBar'\n    },\n    onSubmit: handleOnSubmit\n  },\n  play: testSubmitEvent\n}",...InvalidEmail.parameters?.docs?.source}}}},"?4f7e":function(){}}]);